<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="html.xsl"?>

<x:page xmlns:x="http://lib.unjou.org/Schemas/Style"
       xmlns:xi="http://www.w3.org/2001/XInclude">

<x:script>
$(document).bind("ready", function() {
    $(".delete").bind("click", function(e) {
        e.preventDefault();
        if (confirm("Are you sure you want to delete?")) {
            $.post(e.target.href, { _method: "DELETE" });
        }
    });
});
</x:script>

<section class="main hfeed">

<xi:include href="article.inc.html" />

<h3 id="comments">${comments.length} Comments</h3>

<section class="comments">
{for comment in comments}
    <article class="comment">
        <img src="${comment.gravatarURI()}" class="avatar" />
        <h3>from ${comment.authorLink()} at ${comment.created}</h3>
        ${comment.content}
        <footer>
            <a href="/comments/*${comment.id}" class="delete">delete</a>
        </footer>
    </article>
{/for}
<x:clear />
</section>

<form method="POST" action="/comments">
    <input type="hidden" name="parentId" value="${article.id}" />
    <fieldset>
        <legend>Add a comment</legend>
        <ol>
            <li>
                <label for="name">Name</label>
                <input type="text" name="name" style="width: 40em" />
            </li>
            <li>
                <label for="email">Email (not published)</label>
                <input type="text" name="email" style="width: 40em" />
            </li>
            <li>
                <label for="uri">Website</label>
                <input type="text" name="uri" style="width: 40em" />
            </li>
            <li>
                <label for="content">Content</label>
                <textarea name="content" class="content"></textarea>
            </li>
        </ol>
    </fieldset>
    <fieldset class="submit">
        <button type="submit">Add</button>
    </fieldset>
</form>    

</section>

<xi:include href="aside.inc.html" />

</x:page>
